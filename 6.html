<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Congratulations on graduation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%);
            color: #333;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .container {
            text-align: center;
            z-index: 10;
            position: relative;
            padding: 20px;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #ec4899, #f472b6, #f9a8d4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
            font-weight: 800;
        }

        .subtitle {
            font-size: 1.1rem;
            margin-bottom: 40px;
            color: #6b7280;
            max-width: 500px;
            line-height: 1.6;
            font-weight: 500;
        }

        /* Envelope Styles - MÀU HỒNG PHẤN TRENDY */
        .envelope-container {
            perspective: 1200px;
            margin: 40px 0;
            position: relative;
            z-index: 5;
        }

        .envelope {
            width: 340px;
            height: 220px;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            filter: drop-shadow(0 20px 40px rgba(236, 72, 153, 0.2));
        }

        .envelope:hover {
            transform: translateY(-15px) scale(1.02);
        }

        .envelope.open {
            transform: translateY(-20px) rotateX(15deg) scale(1.05);
        }

        .envelope-front {
            width: 100%;
            height: 100%;
            position: absolute;
            background: linear-gradient(145deg, #fdf2f8, #fce7f3);
            border-radius: 20px;
            box-shadow: 
                inset 0 2px 10px rgba(255, 255, 255, 0.8),
                0 15px 40px rgba(236, 72, 153, 0.15);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transform-origin: bottom;
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            z-index: 2;
            border: 2px solid rgba(255, 255, 255, 0.9);
        }

        .envelope.open .envelope-front {
            transform: rotateX(-180deg);
        }

        .envelope-back {
            width: 100%;
            height: 100%;
            position: absolute;
            background: linear-gradient(145deg, #fdf2f8, #fce7f3);
            border-radius: 20px;
            z-index: 1;
            border: 2px solid rgba(255, 255, 255, 0.9);
        }

        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 170px solid transparent;
            border-right: 170px solid transparent;
            border-top: 110px solid #fce7f3;
            transform-origin: top;
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            z-index: 3;
            filter: drop-shadow(0 -5px 15px rgba(236, 72, 153, 0.1));
        }

        .envelope.open .envelope-flap {
            transform: rotateX(-180deg);
        }

        .envelope-content {
            padding: 30px;
            text-align: center;
            color: #ec4899;
            z-index: 1;
        }

        .envelope-content h2 {
            font-size: 1.8rem;
            margin-bottom: 12px;
            color: #ec4899;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .envelope-content p {
            font-size: 1.1rem;
            opacity: 0.8;
            font-weight: 500;
        }

        .stamp {
            position: absolute;
            top: 25px;
            right: 25px;
            width: 75px;
            height: 75px;
            background: linear-gradient(135deg, #ec4899, #f472b6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 8px 25px rgba(236, 72, 153, 0.3);
            z-index: 4;
            border: 3px solid white;
            font-family: 'Courier New', monospace;
            transform: rotate(5deg);
        }

        /* Letter Styles */
        .letter {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 520px;
            background: linear-gradient(145deg, #fdf2f8, #fce7f3);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 30px 80px rgba(236, 72, 153, 0.25);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            color: #374151;
            max-height: 85vh;
            overflow-y: auto;
            border: 2px solid rgba(255, 255, 255, 0.9);
        }

        .letter.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .letter-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f9a8d4;
        }

        .letter-header h2 {
            font-size: 2.2rem;
            color: #ec4899;
            margin-bottom: 12px;
            font-weight: 800;
        }

        .letter-content {
            line-height: 1.7;
            font-size: 1.15rem;
        }

        .letter-content p {
            margin-bottom: 20px;
        }

        .letter-footer {
            margin-top: 30px;
            text-align: right;
            font-style: italic;
            color: #6b7280;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.3s;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #ec4899;
            background: rgba(236, 72, 153, 0.1);
        }

        /* Fireworks Canvas */
        #fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* Controls */
        .controls {
            margin-top: 30px;
            display: flex;
            gap: 20px;
            z-index: 10;
        }

        button {
            padding: 14px 32px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, #ec4899, #f472b6);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(236, 72, 153, 0.3);
            font-size: 1rem;
            letter-spacing: -0.3px;
        }

        button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(236, 72, 153, 0.4);
        }

        button:active {
            transform: translateY(-2px);
        }

        /* Flowers */
        .flower {
            position: absolute;
            font-size: 2.2rem;
            opacity: 0;
            z-index: 2;
            pointer-events: none;
            filter: drop-shadow(0 5px 15px rgba(236, 72, 153, 0.3));
        }

        /* Responsive */
        @media (max-width: 600px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .envelope {
                width: 300px;
                height: 190px;
            }
            
            .envelope-flap {
                border-left: 150px solid transparent;
                border-right: 150px solid transparent;
                border-top: 95px solid #fce7f3;
            }
            
            .letter {
                padding: 30px;
            }
            
            .letter-header h2 {
                font-size: 1.8rem;
            }
            
            .letter-content {
                font-size: 1rem;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <canvas id="fireworks-canvas"></canvas>
    
    <div class="container">
        <h1>Congratulations on graduation </h1>
        <p class="subtitle"> Ở đây có tình yêu của Minh Thư ạ </p>
        
        <div class="envelope-container">
            <div class="envelope">
                <div class="envelope-back"></div>
                <div class="envelope-front">
                    <div class="envelope-content">
                        <h2>You've Got Mail</h2>
                        <p>Click to open</p>
                    </div>
                </div>
                <div class="envelope-flap"></div>
                <div class="stamp">MTT</div>
            </div>
        </div>
        
        <div class="controls">
            <button id="toggleFireworks">Tắt/Bật Pháo Hoa</button>
            <button id="downloadLetter">Tải Thư</button>
        </div>
    </div>
    
    <div class="letter">
        <button class="close-btn">&times;</button>
        <div class="letter-header">
            <h2> Gửi Trang iu dấu cụa em ! </h2>
            <p> Hà Nội 23/10/2025 </p>
        </div>
        <div class="letter-content">
            <p>Đầu thư em cụng chẳng biết nói gì kiểu nên viết gì nhỉ , sắp xếp cảm  xúc ntn , em biết chị  thời gian cũng không ngắn cũng không dài nhưng cũng đủ để hiểu về chị và ngược lại , ngày mai tốt nghiệp chị òi cũng chẳng biết nói sao cho hợp lý chúc chị ổn định ư dam không giống với chị lắm , em chỉ mong chị an yên tâm hồn tư duy lối sống tích cực và em luôn ở đây nếu chị cần em thì em luôn ở đây chỉ là em hơi bận yêu ạ ý em là htai em đang hơi bận  nma em luôn cố gắng nếu chị cần em thì em luôn ở đây và em luôn mong rằng chị có thể "sống " như cách chị muốn mà không còn phải xem sắc mặt của ai cả yêu điều mình thích thích điều mình làm và luôn mong chị bình bình an an cả đời này </p>
            
        <div class="letter-footer">
            <p>Em thương chị </p>
            <p> Trần Thị Minh Thư </p>
        </div>
    </div>

    <script>
        // DOM Elements
        const envelope = document.querySelector('.envelope');
        const letter = document.querySelector('.letter');
        const closeBtn = document.querySelector('.close-btn');
        const toggleFireworksBtn = document.getElementById('toggleFireworks');
        const downloadLetterBtn = document.getElementById('downloadLetter');
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Variables
        let fireworks = [];
        let particles = [];
        let flowers = [];
        let fireworksEnabled = true;
        let animationId;
        let flowersEnabled = false;
        let flowerInterval;

        // Fireworks colors - MÀU HỒNG PHẤN TRENDY
        const colors = [
            '#ec4899', '#f472b6', '#f9a8d4', '#fdf2f8',
            '#fecaca', '#fed7aa', '#fef3c7', '#d1fae5',
            '#a7f3d0', '#6ee7b7', '#93c5fd', '#c7d2fe'
        ];

        // Flower emojis
        const flowerEmojis = ['🌸', '🌺', '🌷', '🌹', '💐', '🥀', '🌼', '🌻'];

        // Open envelope and show letter
        envelope.addEventListener('click', () => {
            envelope.classList.add('open');
            setTimeout(() => {
                letter.classList.add('show');
                // Bật hiệu ứng hoa rơi khi mở thư
                flowersEnabled = true;
                startFlowerFall();
            }, 400); // Giảm từ 800ms xuống 400ms
        });

        // Close letter
        closeBtn.addEventListener('click', () => {
            letter.classList.remove('show');
            // Tắt hiệu ứng hoa rơi khi đóng thư
            flowersEnabled = false;
            clearInterval(flowerInterval);
            setTimeout(() => {
                envelope.classList.remove('open');
            }, 200); // Giảm từ 400ms xuống 200ms
        });

        // Toggle fireworks
        toggleFireworksBtn.addEventListener('click', () => {
            fireworksEnabled = !fireworksEnabled;
            toggleFireworksBtn.textContent = fireworksEnabled ? 'Tắt Pháo Hoa' : 'Bật Pháo Hoa';
            
            if (fireworksEnabled) {
                // Tạo nhiều pháo hoa khi bật lại
                for (let i = 0; i < 8; i++) {
                    setTimeout(() => createFirework(), i * 80); // Giảm từ 150ms xuống 80ms
                }
            }
        });

        // Download letter
        downloadLetterBtn.addEventListener('click', () => {
            const letterContent = document.querySelector('.letter-content').innerText;
            const headerContent = document.querySelector('.letter-header').innerText;
            const footerContent = document.querySelector('.letter-footer').innerText;
            
            const fullContent = `${headerContent}\n\n${letterContent}\n\n${footerContent}`;
            
            const blob = new Blob([fullContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'thu_chuc_mung_tot_nghiep.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // MODERN FIREWORKS SYSTEM - TĂNG TỐC ĐỘ
        class Particle {
            constructor(x, y, color, velocity, size, shape, glow = false) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.velocity = velocity;
                this.alpha = 1;
                this.decay = Math.random() * 0.02 + 0.01; // Tăng tốc độ biến mất
                this.size = size || Math.random() * 4 + 2;
                this.shape = shape || 'circle';
                this.rotation = Math.random() * Math.PI * 2;
                this.spinSpeed = (Math.random() - 0.5) * 0.15; // Tăng tốc độ xoay
                this.glow = glow;
                this.trail = [];
                this.maxTrail = 2; // Giảm trail để tăng tốc độ
            }
            
            update() {
                // Lưu trail
                this.trail.push({x: this.x, y: this.y, alpha: this.alpha});
                if (this.trail.length > this.maxTrail) {
                    this.trail.shift();
                }
                
                this.velocity.x *= 0.97; // Giảm ma sát để bay nhanh hơn
                this.velocity.y *= 0.97;
                this.velocity.y += 0.025; // Tăng trọng lực
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= this.decay;
                this.rotation += this.spinSpeed;
            }
            
            draw() {
                // Vẽ trail
                for (let i = 0; i < this.trail.length; i++) {
                    const point = this.trail[i];
                    ctx.globalAlpha = point.alpha * (i / this.trail.length) * 0.3;
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(point.x, point.y, this.size * 0.5, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.globalAlpha = this.alpha;
                
                if (this.glow) {
                    ctx.shadowColor = this.color;
                    ctx.shadowBlur = 15;
                }
                
                ctx.fillStyle = this.color;
                
                if (this.shape === 'circle') {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                } else if (this.shape === 'heart') {
                    this.drawHeart(this.x, this.y, this.size);
                } else if (this.shape === 'sparkle') {
                    this.drawSparkle(this.x, this.y, this.size);
                }
                
                if (this.glow) {
                    ctx.shadowBlur = 0;
                }
            }
            
            drawHeart(x, y, size) {
                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(this.rotation);
                ctx.beginPath();
                for (let i = 0; i < 10; i++) {
                    const angle = (i / 10) * Math.PI * 2;
                    const radius = size * (0.8 + Math.sin(angle * 4) * 0.2);
                    const px = Math.cos(angle) * radius;
                    const py = Math.sin(angle) * radius;
                    if (i === 0) ctx.moveTo(px, py);
                    else ctx.lineTo(px, py);
                }
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }
            
            drawSparkle(x, y, size) {
                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(this.rotation);
                
                for (let i = 0; i < 4; i++) {
                    ctx.rotate(Math.PI / 2);
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.lineTo(size, 0);
                    ctx.lineTo(size * 0.7, -size * 0.3);
                    ctx.closePath();
                    ctx.fill();
                }
                ctx.restore();
            }
        }

        class Firework {
            constructor(x, y, targetX, targetY, type = 'normal') {
                this.x = x;
                this.y = y;
                this.targetX = targetX;
                this.targetY = targetY;
                this.color = colors[Math.floor(Math.random() * colors.length)];
                this.velocity = {
                    x: (targetX - x) / 40, // Tăng tốc độ bay lên
                    y: (targetY - y) / 40
                };
                this.alpha = 1;
                this.exploded = false;
                this.particles = [];
                this.type = type;
                this.trail = [];
                this.maxTrail = 6; // Giảm trail
                this.size = 4;
            }
            
            update() {
                if (!this.exploded) {
                    // Lưu trail với hiệu ứng mờ dần
                    this.trail.push({x: this.x, y: this.y, alpha: this.alpha});
                    if (this.trail.length > this.maxTrail) {
                        this.trail.shift();
                    }
                    
                    this.velocity.y += 0.02; // Tăng trọng lực
                    this.x += this.velocity.x;
                    this.y += this.velocity.y;
                    
                    // Vẽ trail
                    this.drawTrail();
                    
                    // Vẽ pháo hoa
                    ctx.globalAlpha = this.alpha;
                    ctx.fillStyle = this.color;
                    ctx.shadowColor = this.color;
                    ctx.shadowBlur = 10;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    
                    // Kiểm tra nổ
                    const distance = Math.sqrt(
                        Math.pow(this.targetX - this.x, 2) + 
                        Math.pow(this.targetY - this.y, 2)
                    );
                    
                    if (distance < 15) { // Tăng khoảng cách nổ
                        this.explode();
                    }
                } else {
                    // Cập nhật particles
                    for (let i = this.particles.length - 1; i >= 0; i--) {
                        this.particles[i].update();
                        this.particles[i].draw();
                        
                        if (this.particles[i].alpha <= 0) {
                            this.particles.splice(i, 1);
                        }
                    }
                }
            }
            
            drawTrail() {
                for (let i = 0; i < this.trail.length; i++) {
                    const point = this.trail[i];
                    const trailAlpha = (i / this.trail.length) * 0.6;
                    ctx.globalAlpha = trailAlpha;
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(point.x, point.y, this.size * (i / this.trail.length), 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            explode() {
                this.exploded = true;
                const particleCount = this.type === 'special' ? 150 : 80; // Giảm số lượng để tăng tốc
                const shapes = ['circle', 'heart', 'sparkle'];
                
                for (let i = 0; i < particleCount; i++) {
                    const velocity = {
                        x: (Math.random() - 0.5) * (this.type === 'special' ? 12 : 8), // Tăng tốc độ bay
                        y: (Math.random() - 0.5) * (this.type === 'special' ? 12 : 8)
                    };
                    
                    const size = Math.random() * 5 + 2;
                    const shape = shapes[Math.floor(Math.random() * shapes.length)];
                    const glow = Math.random() > 0.7;
                    
                    this.particles.push(new Particle(this.x, this.y, this.color, velocity, size, shape, glow));
                }
            }
        }

        function createFirework(x, y, type = 'normal') {
            if (!fireworksEnabled) return;
            
            const targetX = x || Math.random() * canvas.width;
            const targetY = y || Math.random() * canvas.height * 0.3; // Bay cao hơn
            const startX = Math.random() * canvas.width;
            
            fireworks.push(new Firework(startX, canvas.height, targetX, targetY, type));
        }

        function createMultipleFireworks(count, type = 'normal') {
            for (let i = 0; i < count; i++) {
                setTimeout(() => createFirework(null, null, type), i * 40); // Giảm từ 60ms xuống 40ms
            }
        }

        // Flower functions - TĂNG TỐC ĐỘ HOA RƠI
        function startFlowerFall() {
            if (!flowersEnabled) return;
            
            flowerInterval = setInterval(() => {
                for (let i = 0; i < 6; i++) { // Tăng số lượng hoa mỗi lần
                    createFlower();
                }
            }, 200); // Giảm từ 350ms xuống 200ms
        }

        function createFlower() {
            const flower = document.createElement('div');
            flower.className = 'flower';
            flower.textContent = flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)];
            flower.style.left = `${Math.random() * 100}vw`;
            flower.style.top = `-60px`;
            flower.style.fontSize = `${Math.random() * 2 + 2}rem`;
            flower.style.opacity = '0.9';
            flower.style.zIndex = '2';
            document.body.appendChild(flower);
            
            const duration = Math.random() * 3 + 2; // Giảm thời gian rơi từ 5-10s xuống 2-5s
            const horizontalMove = (Math.random() - 0.5) * 500; // Tăng di chuyển ngang
            const rotation = Math.random() * 1080 - 540; // Tăng tốc độ xoay
            
            flower.animate([
                { transform: `translate(0, 0) rotate(0deg)`, opacity: 0.9 },
                { transform: `translate(${horizontalMove}px, 120vh) rotate(${rotation}deg)`, opacity: 0 }
            ], {
                duration: duration * 1000,
                easing: 'cubic-bezier(0.2, 0, 0.8, 1)' // Easing nhanh hơn
            });
            
            setTimeout(() => {
                if (flower.parentNode) {
                    flower.parentNode.removeChild(flower);
                }
            }, duration * 1000);
        }

        // Animation loop
        function animate() {
            // Clear với màu nền hồng phấn nhạt
            ctx.fillStyle = 'rgba(253, 242, 248, 0.1)'; // Tăng độ trong suốt
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            if (fireworksEnabled) {
                for (let i = fireworks.length - 1; i >= 0; i--) {
                    fireworks[i].update();
                    
                    if (fireworks[i].exploded && fireworks[i].particles.length === 0) {
                        fireworks.splice(i, 1);
                    }
                }
                
                // Tạo pháo hoa liên tục với tần suất cao hơn
                if (Math.random() < 0.18) { // Tăng xác suất tạo pháo hoa
                    const type = Math.random() < 0.3 ? 'special' : 'normal';
                    createFirework(null, null, type);
                }
            }
            
            animationId = requestAnimationFrame(animate);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Start animation
        animate();

        // TẠO VƯỜN PHÁO HOA NGAY TỪ ĐẦU - NHANH HƠN
        for (let i = 0; i < 30; i++) { // Tăng số lượng pháo hoa ban đầu
            setTimeout(() => {
                const type = i % 4 === 0 ? 'special' : 'normal'; // Tăng tần suất pháo hoa đặc biệt
                createFirework(null, null, type);
            }, i * 60); // Giảm từ 100ms xuống 60ms
        }

        // Tiếp tục tạo pháo hoa - TĂNG TỐC
        setInterval(() => {
            if (fireworksEnabled) {
                const count = 3 + Math.floor(Math.random() * 4); // Tăng số lượng mỗi lần
                const type = Math.random() < 0.25 ? 'special' : 'normal';
                createMultipleFireworks(count, type);
            }
        }, 500); // Giảm từ 700ms xuống 500ms

        // Pháo hoa đặc biệt mỗi 3 giây
        setInterval(() => {
            if (fireworksEnabled) {
                createMultipleFireworks(5, 'special'); // Tăng số lượng pháo hoa đặc biệt
            }
        }, 3000); // Giảm từ 4000ms xuống 3000ms
    </script>
</body>
</html>