<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title> G·ª≠i c√°c t√¨nh y√™u  üíó</title>
<style>
  :root {
    --bg1: #fff8fb;
    --bg2: #ffeef6;
    --accent: #ff4f81;
  }
  html, body {
    height: 100%;
    margin: 0;
    overflow: hidden;
    font-family: "Poppins", system-ui, Arial;
    background: linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    display: block;
  }

  .screen {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity .8s ease, transform .8s ease;
  }
  .hidden { opacity: 0; pointer-events: none; transform: scale(.98); }

  .centerText {
    position: absolute;
    z-index: 50;
    text-align: center;
    padding: 20px 36px;
    border-radius: 999px;
    border: 2px solid rgba(255,100,150,0.14);
    background: rgba(255,255,255,0.85);
    box-shadow: 0 14px 40px rgba(255,120,160,0.1);
    cursor: pointer;
    transition: transform .15s ease;
  }
  .centerText:hover { transform: scale(1.05); }
  .centerText .title {
    font-size: clamp(22px, 4vw, 36px);
    color: var(--accent);
    font-weight: 800;
  }

  .finalText {
    position: absolute;
    text-align:center;
    left:50%; top:50%;
    transform: translate(-50%,-50%);
    opacity:0;
    transition: opacity 1.5s ease;
    background: rgba(255, 200, 220, 0.25); /* n·ªÅn m·ªù h·ªìng nh·∫°t */
    padding: 16px 32px; border-radius: 20px;
    backdrop-filter: blur(8px); /* l√†m m·ªù n·ªÅn ph√≠a sau */
    z-index: 60;
  }
  .finalText.show { opacity:1; }
  .finalText .main {
    font-size: clamp(22px,5vw,38px); font-weight:800;
    color:#fff; text-shadow: 0 0 12px rgba(255,100,160,0.8);
  }
  .finalText .sub {
    margin-top:6px; color:#fff;
    font-size: clamp(14px,3vw,20px);
    text-shadow:0 0 6px rgba(255,120,180,0.6);
  }
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>
<canvas id="mainCanvas"></canvas>

<!-- M√†n 1 -->
<div id="screen1" class="screen">
  <div class="centerText" id="cta">
    <div class="title">G·ª≠i t√¨nh y√™u c·ªßa em üíó </div>
  </div>
</div>

<!-- M√†n 2 -->
<div id="screen2" class="screen hidden">
  <div id="finalText" class="finalText">
    <div class="main"> Happy women's day üíó</div>
    <div class="sub">Thanks for always being your beautiful, strong self.</div>
  </div>
</div>

<script>
const bgCanvas = document.getElementById("bgCanvas");
const mainCanvas = document.getElementById("mainCanvas");
const bgCtx = bgCanvas.getContext("2d");
const mCtx = mainCanvas.getContext("2d");

function fit() {
  const DPR = window.devicePixelRatio || 1;
  bgCanvas.width = innerWidth * DPR;
  bgCanvas.height = innerHeight * DPR;
  mainCanvas.width = innerWidth * DPR;
  mainCanvas.height = innerHeight * DPR;
  bgCtx.setTransform(DPR, 0, 0, DPR, 0, 0);
  mCtx.setTransform(DPR, 0, 0, DPR, 0, 0);
}
fit();
window.addEventListener("resize", fit);

// --- n·ªÅn hoa & tim r∆°i ---
const bgParticles = [];
const BG_COUNT = Math.round((innerWidth * innerHeight) / 90000 * 60);

function spawnParticle() {
  const type = Math.random() < 0.5 ? "petal" : "heart";
  return {
    x: Math.random() * innerWidth,
    y: Math.random() * innerHeight,
    vx: (Math.random() - 0.5) * 0.5,
    vy: 0.4 + Math.random() * 0.8,
    size: 6 + Math.random() * 14,
    rot: Math.random() * Math.PI * 2,
    drot: (Math.random() - 0.5) * 0.02,
    alpha: 0.6 + Math.random() * 0.4,
    type
  };
}
for (let i = 0; i < BG_COUNT; i++) bgParticles.push(spawnParticle());

function drawBg(dt) {
  bgCtx.clearRect(0, 0, innerWidth, innerHeight);
  for (let p of bgParticles) {
    p.x += p.vx * dt * 0.06;
    p.y += p.vy * dt * 0.06;
    p.rot += p.drot * dt * 0.06;
    bgCtx.save();
    bgCtx.globalAlpha = p.alpha;
    bgCtx.translate(p.x, p.y);
    bgCtx.rotate(p.rot);
    if (p.type === "petal") {
      bgCtx.fillStyle = "rgba(255,200,220,0.8)";
      bgCtx.beginPath();
      bgCtx.ellipse(0, 0, p.size * 0.5, p.size, 0, 0, Math.PI * 2);
      bgCtx.fill();
    } else {
      bgCtx.scale(p.size / 12, p.size / 12);
      bgCtx.beginPath();
      bgCtx.moveTo(0, 0);
      bgCtx.bezierCurveTo(0, -6, -5, -14, -12, -14);
      bgCtx.bezierCurveTo(-25, -14, -25, 6, 0, 20);
      bgCtx.bezierCurveTo(25, 6, 25, -14, 12, -14);
      bgCtx.bezierCurveTo(5, -14, 0, -6, 0, 0);
      bgCtx.fillStyle = "rgba(255,120,160,0.7)";
      bgCtx.fill();
    }
    bgCtx.restore();
    if (p.y > innerHeight + 30) {
      p.x = Math.random() * innerWidth;
      p.y = -20;
    }
  }
}

// --- tim gh√©p ---
let assembling = false, assembled = false, assembleParticles = [], pulse = 0;

function heartPoints(cx, cy, s, count = 250) {
  const pts = [];
  for (let i = 0; i < count; i++) {
    const t = Math.PI * 2 * (i / count);
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
    pts.push({x: cx + x * s, y: cy - y * s});
  }
  return pts;
}

function startAssemble() {
  assembleParticles = [];
  const cx = innerWidth / 2, cy = innerHeight / 2;
  const s = Math.min(innerWidth, innerHeight) / 35;
  const pts = heartPoints(cx, cy, s);
  for (let pt of pts) {
    assembleParticles.push({
      x: Math.random() * innerWidth,
      y: innerHeight + Math.random() * 200,
      tx: pt.x, ty: pt.y,
      vx: 0, vy: 0,
      size: 5 + Math.random() * 6,
      hue: 320 + Math.random() * 30,
      alpha: 0.9
    });
  }
  assembling = true;
}

function drawAssemble(dt) {
  if (!assembling) return;
  let done = true;
  for (let p of assembleParticles) {
    p.vx += (p.tx - p.x) * 0.05;
    p.vy += (p.ty - p.y) * 0.05;
    p.vx *= 0.88; p.vy *= 0.88;
    p.x += p.vx * dt * 0.06;
    p.y += p.vy * dt * 0.06;
    mCtx.save();
    mCtx.globalAlpha = p.alpha;
    mCtx.translate(p.x, p.y);
    mCtx.scale(p.size / 12, p.size / 12);
    mCtx.beginPath();
    mCtx.moveTo(0, 0);
    mCtx.bezierCurveTo(0, -6, -5, -14, -12, -14);
    mCtx.bezierCurveTo(-25, -14, -25, 6, 0, 20);
    mCtx.bezierCurveTo(25, 6, 25, -14, 12, -14);
    mCtx.bezierCurveTo(5, -14, 0, -6, 0, 0);
    mCtx.fillStyle = `hsl(${p.hue}, 80%, 70%)`;
    mCtx.fill();
    mCtx.restore();
    if (Math.hypot(p.x - p.tx, p.y - p.ty) > 3) done = false;
  }
  if (done && !assembled) assembled = true;
}

let last = performance.now();
function loop(now) {
  const dt = now - last; last = now;
  drawBg(dt);
  mCtx.clearRect(0, 0, innerWidth, innerHeight);
  drawAssemble(dt);
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

const screen1 = document.getElementById("screen1");
const screen2 = document.getElementById("screen2");
const cta = document.getElementById("cta");
const finalText = document.getElementById("finalText");

cta.addEventListener("click", () => {
  screen1.classList.add("hidden");
  setTimeout(() => {
    screen1.style.display = "none";
    screen2.style.display = "flex";
    screen2.classList.remove("hidden");
    setTimeout(startAssemble, 500);
    const timer = setInterval(() => {
      if (assembled) { 
        finalText.classList.add("show"); 
        clearInterval(timer); 
      }
    }, 200);
  }, 700);
});
</script>
</body>
</html>
