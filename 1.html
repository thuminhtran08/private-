<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>G·ª≠i c√°c t√¨nh y√™u üíó</title>

<!-- Import font Poppins -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  :root {
    --bg1: #fff8fb;
    --bg2: #ffeef6;
    --accent: #ff4f81;
  }

  * {
    -webkit-tap-highlight-color: transparent;
  }

  html, body {
    height: 100%;
    margin: 0;
    overflow: hidden;
    font-family: "Poppins", system-ui, Arial;
    background: linear-gradient(180deg, var(--bg1), var(--bg2));
    touch-action: none;
  }

  canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    display: block;
  }

  .screen {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity .8s ease, transform .8s ease;
  }
  .hidden { opacity: 0; pointer-events: none; transform: scale(.98); }

  .centerText {
    position: absolute;
    z-index: 50;
    text-align: center;
    padding: 20px 36px;
    border-radius: 999px;
    border: 2px solid rgba(255,100,150,0.14);
    background: rgba(255,255,255,0.85);
    box-shadow: 0 14px 40px rgba(255,120,160,0.1);
    cursor: pointer;
    transition: transform .15s ease;
  }
  .centerText:active { transform: scale(1.05); }
  .centerText .title {
    font-size: clamp(22px, 4vw, 36px);
    color: var(--accent);
    font-weight: 800;
  }

  .finalText {
    position: absolute;
    text-align:center;
    left:50%; top:50%;
    transform: translate(-50%,-50%);
    opacity:0;
    transition: opacity 1.5s ease;
    z-index: 70;
    width: 80%;
    max-width: 320px;
    pointer-events: none;
  }
  .finalText.show { opacity:1; }
  .finalText .main {
    font-size: clamp(20px,4.5vw,28px); 
    font-weight:800;
    color:#fff; 
    text-shadow: 0 2px 15px rgba(255,100,160,0.9);
    margin-bottom: 6px;
    line-height: 1.3;
  }
  .finalText .sub {
    color:#fff;
    font-size: clamp(13px,2.8vw,16px);
    text-shadow: 0 2px 10px rgba(255,120,180,0.8);
    line-height: 1.4;
  }
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>
<canvas id="mainCanvas"></canvas>

<!-- M√†n 1 -->
<div id="screen1" class="screen">
  <div class="centerText" id="cta">
    <div class="title">For my love  üíó</div>
  </div>
</div>

<!-- M√†n 2 -->
<div id="screen2" class="screen hidden">
  <div id="finalText" class="finalText">
    <div class="main">Happy Women's Day</div>
    <div class="sub">Thanks for always being your beautiful, strong self.</div>
  </div>
</div>

<script>
const bgCanvas = document.getElementById("bgCanvas");
const mainCanvas = document.getElementById("mainCanvas");
const bgCtx = bgCanvas.getContext("2d");
const mCtx = mainCanvas.getContext("2d");

function fit() {
  const DPR = window.devicePixelRatio || 1;
  bgCanvas.width = innerWidth * DPR;
  bgCanvas.height = innerHeight * DPR;
  mainCanvas.width = innerWidth * DPR;
  mainCanvas.height = innerHeight * DPR;
  bgCtx.setTransform(DPR, 0, 0, DPR, 0, 0);
  mCtx.setTransform(DPR, 0, 0, DPR, 0, 0);
}
fit();
window.addEventListener("resize", fit);

// --- n·ªÅn hoa & tim r∆°i ---
const bgParticles = [];
const BG_COUNT = Math.round((innerWidth * innerHeight) / 90000 * 25);

function spawnParticle() {
  const type = Math.random() < 0.6 ? "petal" : "heart";
  return {
    x: Math.random() * innerWidth,
    y: Math.random() * innerHeight,
    vx: (Math.random() - 0.5) * 0.3,
    vy: 0.3 + Math.random() * 0.6,
    size: 4 + Math.random() * 10,
    rot: Math.random() * Math.PI * 2,
    drot: (Math.random() - 0.5) * 0.01,
    alpha: 0.5 + Math.random() * 0.3,
    type
  };
}
for (let i = 0; i < BG_COUNT; i++) bgParticles.push(spawnParticle());

function drawBg() {
  bgCtx.clearRect(0, 0, innerWidth, innerHeight);
  for (let p of bgParticles) {
    p.x += p.vx;
    p.y += p.vy;
    p.rot += p.drot;
    
    if (p.y > innerHeight + 30) {
      p.x = Math.random() * innerWidth;
      p.y = -20;
    }
    
    bgCtx.save();
    bgCtx.globalAlpha = p.alpha;
    bgCtx.translate(p.x, p.y);
    bgCtx.rotate(p.rot);
    
    if (p.type === "petal") {
      bgCtx.fillStyle = "rgba(255,200,220,0.7)";
      bgCtx.beginPath();
      bgCtx.ellipse(0, 0, p.size * 0.4, p.size * 0.8, 0, 0, Math.PI * 2);
      bgCtx.fill();
    } else {
      const scale = p.size / 15;
      bgCtx.scale(scale, scale);
      bgCtx.beginPath();
      bgCtx.moveTo(0, 0);
      bgCtx.bezierCurveTo(0, -4, -3, -9, -8, -9);
      bgCtx.bezierCurveTo(-15, -9, -15, 3, 0, 12);
      bgCtx.bezierCurveTo(15, 3, 15, -9, 8, -9);
      bgCtx.bezierCurveTo(3, -9, 0, -4, 0, 0);
      bgCtx.fillStyle = "rgba(255,120,160,0.6)";
      bgCtx.fill();
    }
    bgCtx.restore();
  }
}

// --- TR√ÅI TIM L·ªöN √îM TEXT ---
let assembling = false, assembled = false, assembleParticles = [];
let heartBeatPhase = 0;

function heartPoints(cx, cy, s, count = 180) {
  const pts = [];
  for (let i = 0; i < count; i++) {
    const t = Math.PI * 2 * (i / count);
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
    pts.push({
      x: cx + x * s,
      y: cy - y * s,
      angle: Math.atan2(-y * s, x * s)
    });
  }
  return pts;
}

function startAssemble() {
  assembleParticles = [];
  const cx = innerWidth / 2, cy = innerHeight / 2;
  const s = Math.min(innerWidth, innerHeight) / 25; // TIM L·ªöN H∆†N
  
  const pts = heartPoints(cx, cy, s);
  const textWidth = 280; // ∆Ø·ªõc l∆∞·ª£ng chi·ªÅu r·ªông text
  
  for (let pt of pts) {
    // Xu·∫•t ph√°t t·ª´ v·ªã tr√≠ xung quanh ƒëi·ªÉm ƒë√≠ch
    const distance = 80 + Math.random() * 60;
    const startX = pt.x + Math.cos(pt.angle) * distance;
    const startY = pt.y + Math.sin(pt.angle) * distance;
    
    assembleParticles.push({
      x: startX,
      y: startY,
      tx: pt.x, 
      ty: pt.y,
      vx: 0, 
      vy: 0,
      size: 1.5 + Math.random() * 2, // Nh·ªè v√† m·∫£nh
      hue: 330 + Math.random() * 15,
      alpha: 0.7 + Math.random() * 0.3,
      delay: Math.random() * 800 // Delay ng·∫´u nhi√™n
    });
  }
  assembling = true;
  heartBeatPhase = 0;
}

function drawAssemble() {
  if (!assembling) return;
  
  let done = true;
  const currentTime = Date.now();
  
  for (let p of assembleParticles) {
    if (currentTime < p.delay) {
      done = false;
      continue;
    }
    
    const dx = p.tx - p.x;
    const dy = p.ty - p.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist > 1) {
      done = false;
      // Chuy·ªÉn ƒë·ªông nh·∫π nh√†ng
      p.vx += dx * 0.04;
      p.vy += dy * 0.04;
      p.vx *= 0.92;
      p.vy *= 0.92;
      p.x += p.vx;
      p.y += p.vy;
    }
    
    mCtx.save();
    mCtx.globalAlpha = p.alpha * Math.min(1, dist / 20);
    mCtx.fillStyle = `hsla(${p.hue}, 85%, 70%, 0.8)`;
    mCtx.beginPath();
    mCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    mCtx.fill();
    mCtx.restore();
  }
  
  if (done && !assembled) {
    assembled = true;
    startHeartBeat();
  }
}

// Hi·ªáu ·ª©ng tim ƒë·∫≠p nh·∫π nh√†ng
function startHeartBeat() {
  heartBeatPhase = 0;
  animateHeartBeat();
}

function animateHeartBeat() {
  if (!assembled) return;
  
  heartBeatPhase += 0.02;
  // Hi·ªáu ·ª©ng ƒë·∫≠p nh·∫π nh√†ng
  const scale = 1 + Math.sin(heartBeatPhase * 2) * 0.015;
  
  mCtx.clearRect(0, 0, innerWidth, innerHeight);
  const centerX = innerWidth / 2;
  const centerY = innerHeight / 2;
  
  for (let p of assembleParticles) {
    const dx = p.x - centerX;
    const dy = p.y - centerY;
    
    mCtx.save();
    mCtx.globalAlpha = p.alpha;
    mCtx.fillStyle = `hsla(${p.hue}, 85%, 70%, 0.8)`;
    mCtx.beginPath();
    mCtx.arc(
      centerX + dx * scale, 
      centerY + dy * scale, 
      p.size, 0, Math.PI * 2
    );
    mCtx.fill();
    mCtx.restore();
  }
  
  requestAnimationFrame(animateHeartBeat);
}

// Main loop
function loop() {
  drawBg();
  if (!assembled) {
    drawAssemble();
  }
  requestAnimationFrame(loop);
}
loop();

const screen1 = document.getElementById("screen1");
const screen2 = document.getElementById("screen2");
const cta = document.getElementById("cta");
const finalText = document.getElementById("finalText");

cta.addEventListener("click", () => {
  screen1.classList.add("hidden");
  setTimeout(() => {
    screen1.style.display = "none";
    screen2.style.display = "flex";
    screen2.classList.remove("hidden");
    
    // Reset state
    assembling = false;
    assembled = false;
    assembleParticles = [];
    
    setTimeout(() => {
      startAssemble();
      
      // Hi·ªán text sau khi tim h√¨nh th√†nh
      const checkTimer = setInterval(() => {
        if (assembled) {
          setTimeout(() => {
            finalText.classList.add("show");
          }, 300);
          clearInterval(checkTimer);
        }
      }, 100);
    }, 400);
  }, 500);
});

// Touch event cho mobile
cta.addEventListener('touchend', (e) => {
  e.preventDefault();
  cta.click();
});

// NgƒÉn scroll tr√™n mobile
document.addEventListener('touchmove', (e) => {
  e.preventDefault();
}, { passive: false });
</script>

</body>
</html>